---
title: "Homework 3"
author: "Teshawna Badu"
date: 10/20/2021
output: github_document
---

I'm an R Markdown document!

```{r setup}
library(tidyverse)
library(dplyr)
library(p8105.datasets)
library(janitor)
```

## Question 1 
```{r}
data("instacart")
```

Description: 
Instacart is an American company that operates in grocery delivery and pick up services. The `instacart` dataset contains data from 2017. It has `r nrow(instacart)` observations and `r ncol(instacart)` variables. The total number of data points in this dataset is `r nrow(instacart)*ncol(instacart)`. The key variables in this dataset include `r colnames(instacart)`. 

### How many aisles are there and which are the most ordered from?
```{r, message = FALSE, warning = FALSE}
instacart %>% 
	count(aisle) %>% 
	arrange(desc(n))
```
There are 134 `aisles`. The aisles with the most ordered-from items are 
`fresh vegetables`, `fresh fruits`, and followed by `packaged vegetables fruits`. 

### make a plot 
This plot shows the number of items ordered per aisle, limited to 10,000 items ordered.
```{r aisles_plot}
instacart %>%
  count(aisle) %>%
  filter(n > 10000) %>%
  ggplot(aes(forcats::fct_reorder(aisle, (n)), n)) +
  geom_col() +
  coord_flip() +
  labs(
    title = "Number of items ordered per aisle",
    x = "Aisle name",
    y = "Number of items ordered",
    caption = "Data from instacart limited to aisles with more than 10,000 items ordered"
  )
```

### make a table 
This table shows three most popular items in each of the aisles “baking ingredients”, “dog food care”, and “packaged vegetables fruits”, Including the number of times each item is ordered. 

```{r aisles_table}
instacart %>%
  filter(aisle == "baking ingredients" | 
           aisle == "dog food care" | 
           aisle == "packaged vegetables fruits") %>%
 count(aisle, product_name) %>%
  arrange(desc(n)) %>%
  group_by(aisle) %>%
  slice(1:3) %>%
  arrange(desc(n)) %>%
  group_by(aisle) %>%
  knitr::kable(caption = "Top  3  Items Per Aisle")
```

The table shows that `organic baby spinach`, `organic raspberries`, and `organic blueberries` 
are the top three ordered items from the `packaged vegetables fruits` aisle. 
From the `baking ingredients` aisle, `light brown sugar`, `pure baking soda`, and `cane sugar` are the top three ordered items. The top three ordered items from the `dog food care` aisle are`snack sticks chicken & rice recipe dog treats`, `organix chicken & brown rice recipe`, and `small dog biscuits`.


### 2x7 table showing the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week.

```{r apples_ice_cream_table}
 instacart %>% 
	filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>% 
	group_by(product_name, order_dow) %>% 
	summarize(mean_hour = mean(order_hour_of_day)) %>% 
	pivot_wider(
		names_from = order_dow,
		values_from = mean_hour
  ) %>%
  rename( "Sunday" = "0","Monday" = "1", "Tuesday" = "2", "Wednesday" = "3", "Thursday" = "4", "Friday" = "5", "Saturday" = "6") %>% 
  knitr::kable(caption = "Mean Hour of Day Ordered")
```
`Coffee Ice Cream` is ordered, on average, later in the day than `Pink Lady Apples`.

